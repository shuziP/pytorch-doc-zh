
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>用例子学习 PyTorch · Pytorch 中文文档</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="ApacheCN">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-insert-logo/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-pageview-count/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-emphasize/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-alerts/style.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-advanced-emoji/emoji-website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="transfer_learning_tutorial.html" />
    
    
    <link rel="prev" href="data_loading_tutorial.html" />
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {"buttons":[{"user":"apachecn","repo":"pytorch-doc-zh","type":"star","count":true,"size":"small"}]};
    </script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    中文教程
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" >
            
                <span>
            
                    
                    入门
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="deep_learning_60min_blitz.html">
            
                <a href="deep_learning_60min_blitz.html">
            
                    
                    PyTorch 深度学习: 60 分钟极速入门
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="data_loading_tutorial.html">
            
                <a href="data_loading_tutorial.html">
            
                    
                    数据加载和处理教程
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.1.3" data-path="pytorch_with_examples.html">
            
                <a href="pytorch_with_examples.html">
            
                    
                    用例子学习 PyTorch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.4" data-path="transfer_learning_tutorial.html">
            
                <a href="transfer_learning_tutorial.html">
            
                    
                    迁移学习教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.5" data-path="deploy_seq2seq_hybrid_frontend_tutorial.html">
            
                <a href="deploy_seq2seq_hybrid_frontend_tutorial.html">
            
                    
                    部署与TorchScript一个Seq2Seq模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.6" data-path="../intermediate/tensorboard_tutorial.html">
            
                <a href="../intermediate/tensorboard_tutorial.html">
            
                    
                    可视化模型，数据，和与训练TensorBoard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.7" data-path="saving_loading_models.html">
            
                <a href="saving_loading_models.html">
            
                    
                    保存和加载模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.8" data-path="nn_tutorial.html">
            
                <a href="nn_tutorial.html">
            
                    
                    torch.nn 到底是什么？
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" >
            
                <span>
            
                    
                    图片
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../intermediate/torchvision_tutorial.html">
            
                <a href="../intermediate/torchvision_tutorial.html">
            
                    
                    TorchVision对象检测教程细化和微调
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="finetuning_torchvision_models_tutorial.html">
            
                <a href="finetuning_torchvision_models_tutorial.html">
            
                    
                    微调Torchvision模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../intermediate/spatial_transformer_tutorial.html">
            
                <a href="../intermediate/spatial_transformer_tutorial.html">
            
                    
                    空间变压器网络教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="../advanced/neural_style_tutorial.html">
            
                <a href="../advanced/neural_style_tutorial.html">
            
                    
                    使用PyTorch进行神经网络传递
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5" data-path="fgsm_tutorial.html">
            
                <a href="fgsm_tutorial.html">
            
                    
                    对抗性示例生成
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6" data-path="dcgan_faces_tutorial.html">
            
                <a href="dcgan_faces_tutorial.html">
            
                    
                    DCGAN教程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" >
            
                <span>
            
                    
                    音频
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="audio_preprocessing_tutorial.html">
            
                <a href="audio_preprocessing_tutorial.html">
            
                    
                    torchaudio教程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" >
            
                <span>
            
                    
                    文本
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../intermediate/char_rnn_classification_tutorial.html">
            
                <a href="../intermediate/char_rnn_classification_tutorial.html">
            
                    
                    NLP从头：判断名称与字符级RNN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../intermediate/char_rnn_generation_tutorial.html">
            
                <a href="../intermediate/char_rnn_generation_tutorial.html">
            
                    
                    NLP从头：生成名称与字符级RNN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="../intermediate/seq2seq_translation_tutorial.html">
            
                <a href="../intermediate/seq2seq_translation_tutorial.html">
            
                    
                    NLP从无到有：用序列到序列网络和翻译注意
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4" data-path="text_sentiment_ngrams_tutorial.html">
            
                <a href="text_sentiment_ngrams_tutorial.html">
            
                    
                    文本分类与TorchText 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.5" data-path="torchtext_translation_tutorial.html">
            
                <a href="torchtext_translation_tutorial.html">
            
                    
                    语言翻译与TorchText 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.6" data-path="transformer_tutorial.html">
            
                <a href="transformer_tutorial.html">
            
                    
                    序列到序列与nn.Transformer和TorchText建模
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" >
            
                <span>
            
                    
                    在生产部署PyTorch模型
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.5.1" data-path="../intermediate/flask_rest_api_tutorial.html">
            
                <a href="../intermediate/flask_rest_api_tutorial.html">
            
                    
                    1.部署PyTorch在Python经由REST API从Flask
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.2" data-path="Intro_to_TorchScript_tutorial.html">
            
                <a href="Intro_to_TorchScript_tutorial.html">
            
                    
                    2.介绍TorchScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.3" data-path="../advanced/cpp_export.html">
            
                <a href="../advanced/cpp_export.html">
            
                    
                    3.装载++一个TorchScript模型在C 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5.4" data-path="../advanced/super_resolution_with_onnxruntime.html">
            
                <a href="../advanced/super_resolution_with_onnxruntime.html">
            
                    
                    4.（可选）从导出到PyTorch一个ONNX模型并使用ONNX运行时运行它
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.6" >
            
                <span>
            
                    
                    并行和分布式训练
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1" data-path="../intermediate/model_parallel_tutorial.html">
            
                <a href="../intermediate/model_parallel_tutorial.html">
            
                    
                    1.型号并行最佳实践
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.2" data-path="../intermediate/ddp_tutorial.html">
            
                <a href="../intermediate/ddp_tutorial.html">
            
                    
                    2.入门分布式数据并行
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.3" data-path="../intermediate/dist_tuto.html">
            
                <a href="../intermediate/dist_tuto.html">
            
                    
                    3. PyTorch编写分布式应用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.4" data-path="aws_distributed_training_tutorial.html">
            
                <a href="aws_distributed_training_tutorial.html">
            
                    
                    4.（高级）PyTorch 1.0分布式训练与Amazon AWS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.7" >
            
                <span>
            
                    
                    扩展PyTorch
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.7.1" data-path="../advanced/torch_script_custom_ops.html">
            
                <a href="../advanced/torch_script_custom_ops.html">
            
                    
                    使用自定义 C++ 扩展算TorchScript 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.2" data-path="../advanced/numpy_extensions_tutorial.html">
            
                <a href="../advanced/numpy_extensions_tutorial.html">
            
                    
                    创建扩展使用numpy的和SciPy的
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7.3" data-path="../advanced/cpp_extension.html">
            
                <a href="../advanced/cpp_extension.html">
            
                    
                    自定义 C++ 和CUDA扩展
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.8" >
            
                <span>
            
                    
                    PyTorch在其他语言
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.8.1" data-path="../advanced/cpp_frontend.html">
            
                <a href="../advanced/cpp_frontend.html">
            
                    
                    使用PyTorch C++ 前端
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    中文文档
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    注解
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../notes/autograd.html">
            
                <a href="../notes/autograd.html">
            
                    
                    自动求导机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../notes/broadcasting.html">
            
                <a href="../notes/broadcasting.html">
            
                    
                    广播语义
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../notes/cpu_threading_torchscript_inference.html">
            
                <a href="../notes/cpu_threading_torchscript_inference.html">
            
                    
                    CPU线程和TorchScript推理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="../notes/cuda.html">
            
                <a href="../notes/cuda.html">
            
                    
                    CUDA语义
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="../notes/extending.html">
            
                <a href="../notes/extending.html">
            
                    
                    扩展PyTorch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.6" data-path="../notes/faq.html">
            
                <a href="../notes/faq.html">
            
                    
                    常见问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.7" data-path="../notes/large_scale_deployments.html">
            
                <a href="../notes/large_scale_deployments.html">
            
                    
                    对于大规模部署的特点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.8" data-path="../notes/multiprocessing.html">
            
                <a href="../notes/multiprocessing.html">
            
                    
                    多处理最佳实践
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.9" data-path="../notes/randomness.html">
            
                <a href="../notes/randomness.html">
            
                    
                    重复性
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.10" data-path="../notes/serialization.html">
            
                <a href="../notes/serialization.html">
            
                    
                    序列化语义
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.11" data-path="../notes/windows.html">
            
                <a href="../notes/windows.html">
            
                    
                    Windows 常见问题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" >
            
                <span>
            
                    
                    社区
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../community/contribution_guide.html">
            
                <a href="../community/contribution_guide.html">
            
                    
                    PyTorch贡献说明书
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../community/governance.html">
            
                <a href="../community/governance.html">
            
                    
                    PyTorch治理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../community/persons_of_interest.html">
            
                <a href="../community/persons_of_interest.html">
            
                    
                    PyTorch治理 | 感兴趣的人
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" >
            
                <span>
            
                    
                    封装参考文献
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../torch.html">
            
                <a href="../torch.html">
            
                    
                    torch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="../tensors.html">
            
                <a href="../tensors.html">
            
                    
                    torch.Tensor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="../tensor_attributes.html">
            
                <a href="../tensor_attributes.html">
            
                    
                    Tensor Attributes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="../type_info.html">
            
                <a href="../type_info.html">
            
                    
                    Type Info
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.5" data-path="../sparse.html">
            
                <a href="../sparse.html">
            
                    
                    torch.sparse
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.6" data-path="../cuda.html">
            
                <a href="../cuda.html">
            
                    
                    torch.cuda
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.7" data-path="../storage.html">
            
                <a href="../storage.html">
            
                    
                    torch.Storage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.8" data-path="../nn.html">
            
                <a href="../nn.html">
            
                    
                    torch.nn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.9" data-path="../nn.functional.html">
            
                <a href="../nn.functional.html">
            
                    
                    torch.nn.functional
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.10" data-path="../nn.init.html">
            
                <a href="../nn.init.html">
            
                    
                    torch.nn.init
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.11" data-path="../optim.html">
            
                <a href="../optim.html">
            
                    
                    torch.optim
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.12" data-path="../autograd.html">
            
                <a href="../autograd.html">
            
                    
                    torch.autograd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.13" data-path="../distributed.html">
            
                <a href="../distributed.html">
            
                    
                    torch.distributed
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.14" data-path="../distributions.html">
            
                <a href="../distributions.html">
            
                    
                    torch.distributions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.15" data-path="../hub.html">
            
                <a href="../hub.html">
            
                    
                    torch.hub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.16" data-path="../jit.html">
            
                <a href="../jit.html">
            
                    
                    torch.jit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.17" data-path="../multiprocessing.html">
            
                <a href="../multiprocessing.html">
            
                    
                    torch.multiprocessing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.18" data-path="../random.html">
            
                <a href="../random.html">
            
                    
                    torch.random
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.19" data-path="../bottleneck.html">
            
                <a href="../bottleneck.html">
            
                    
                    torch.utils.bottleneck
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.20" data-path="../checkpoint.html">
            
                <a href="../checkpoint.html">
            
                    
                    torch.utils.checkpoint
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.21" data-path="../cpp_extension.html">
            
                <a href="../cpp_extension.html">
            
                    
                    torch.utils.cpp_extension
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.22" data-path="../data.html">
            
                <a href="../data.html">
            
                    
                    torch.utils.data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.23" data-path="../dlpack.html">
            
                <a href="../dlpack.html">
            
                    
                    torch.utils.dlpack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.24" data-path="../model_zoo.html">
            
                <a href="../model_zoo.html">
            
                    
                    torch.utils.model_zoo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.25" data-path="../tensorboard.html">
            
                <a href="../tensorboard.html">
            
                    
                    torch.utils.tensorboard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.26" data-path="../onnx.html">
            
                <a href="../onnx.html">
            
                    
                    torch.onnx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.27" data-path="../__config__.md">
            
                <span>
            
                    
                    torch. config
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" >
            
                <span>
            
                    
                    torchvision 参考文献
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../torchvision/">
            
                <a href="../torchvision/">
            
                    
                    torchvision
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" >
            
                <span>
            
                    
                    torchaudio Reference
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.5.1" >
            
                <a target="_blank" href="https://pytorch.org/audio">
            
                    
                    torchaudio
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.6" >
            
                <span>
            
                    
                    torchtext Reference
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.6.1" >
            
                <a target="_blank" href="https://pytorch.org/text">
            
                    
                    torchtext
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >用例子学习 PyTorch</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="&#x4E0E;&#x5B9E;&#x65BD;&#x4F8B;&#x5B66;&#x4E60;pytorch">&#x4E0E;&#x5B9E;&#x65BD;&#x4F8B;&#x5B66;&#x4E60;PyTorch</h1>
<p><strong>&#x4F5C;&#x8005;</strong> &#xFF1A;<a href="https://github.com/jcjohnson/pytorch-examples" target="_blank">&#x8D3E;&#x65AF;&#x6C40;&#xB7;&#x7EA6;&#x7FF0;&#x900A;</a></p>
<p>&#x8FD9;&#x4E2A;&#x6559;&#x7A0B;&#x901A;&#x8FC7;&#x81EA;&#x5305;&#x542B;&#x7684;&#x5B9E;&#x65BD;&#x4F8B;&#x5F15;&#x5165;&#x4E86;<a href="https://github.com/pytorch/pytorch" target="_blank">&#x7684;&#x57FA;&#x672C;&#x6982;&#x5FF5;PyTorch </a>&#x3002;</p>
<p>&#x5728;&#x5176;&#x6838;&#x5FC3;&#xFF0C;PyTorch&#x63D0;&#x4F9B;&#x4E86;&#x4E24;&#x4E2A;&#x4E3B;&#x8981;&#x7279;&#x70B9;&#xFF1A;</p>
<ul>
<li>n&#x7EF4;&#x5F20;&#x91CF;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;numpy&#x7684;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x5728;GPU&#x4E0A;&#x8FD0;&#x884C;</li>
<li>&#x81EA;&#x52A8;&#x5206;&#x5316;&#x4E3A;&#x5EFA;&#x8BBE;&#x548C;&#x57F9;&#x8BAD;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;</li>
</ul>
<p>&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;&#x5168;&#x8FDE;&#x63A5;RELU&#x7F51;&#x7EDC;&#x6211;&#x4EEC;&#x5F53;&#x524D;&#x5B9E;&#x4F8B;&#x3002;&#x8BE5;&#x7F51;&#x7EDC;&#x5C06;&#x5177;&#x6709;&#x5355;&#x4E2A;&#x9690;&#x85CF;&#x5C42;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x4E0E;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x6765;&#x8BAD;&#x7EC3;&#x901A;&#x8FC7;&#x6700;&#x5C0F;&#x5316;&#x7F51;&#x7EDC;&#x8F93;&#x51FA;&#x548C;&#x771F;&#x5B9E;&#x8F93;&#x51FA;&#x4E4B;&#x95F4;&#x7684;&#x6B27;&#x51E0;&#x91CC;&#x5F97;&#x8DDD;&#x79BB;&#xFF0C;&#x4EE5;&#x9002;&#x5E94;&#x968F;&#x673A;&#x6570;&#x636E;&#x3002;</p>
<p>&#x6CE8;&#x610F;</p>
<p>&#x60A8;&#x53EF;&#x4EE5;&#x5728;&#x6B64;&#x9875;&#x9762; &#x7684; &#x5E74;&#x5E95;&#x6D4F;&#x89C8;&#x4E2A;&#x522B;&#x7684;&#x4F8B;&#x5B50;&#x3002;</p>
<p>&#x76EE;&#x5F55;</p>
<ul>
<li>&#x5F20;&#x91CF;<ul>
<li>&#x70ED;&#x8EAB;&#xFF1A;numpy&#x7684;</li>
<li>PyTorch&#xFF1A;&#x5F20;&#x91CF;</li>
</ul>
</li>
<li>Autograd <ul>
<li>PyTorch&#xFF1A;&#x5F20;&#x91CF;&#x548C;autograd </li>
<li>PyTorch&#xFF1A;&#x5B9A;&#x4E49;&#x65B0;autograd&#x529F;&#x80FD;</li>
<li>TensorFlow&#xFF1A;&#x9759;&#x6001;&#x56FE;&#x5F62;</li>
</ul>
</li>
<li>NN &#x6A21;&#x5757;<ul>
<li>PyTorch&#xFF1A;NN </li>
<li>PyTorch&#xFF1A;&#x7684;Optim </li>
<li>PyTorch&#xFF1A;&#x81EA;&#x5B9A;&#x4E49;&#x30F3;&#x6A21;&#x5757;</li>
<li>PyTorch&#xFF1A;&#x63A7;&#x5236;&#x6D41;+&#x91CD;&#x91CF;&#x5171;&#x4EAB;</li>
</ul>
</li>
<li>&#x5B9E;&#x65BD;&#x4F8B;<ul>
<li>&#x5F20;&#x91CF;</li>
<li>Autograd </li>
<li>NN &#x6A21;&#x5757;</li>
</ul>
</li>
</ul>
<h2 id="&#x5F20;&#x91CF;">&#x5F20;&#x91CF;</h2>
<h3 id="&#x70ED;&#x8EAB;&#xFF1A;numpy&#x7684;">&#x70ED;&#x8EAB;&#xFF1A;numpy&#x7684;</h3>
<p>&#x5F15;&#x5165;PyTorch&#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;numpy&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5B9E;&#x65BD;&#x7F51;&#x7EDC;&#x3002;</p>
<p>numpy&#x7684;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;n&#x7EF4;&#x9635;&#x5217;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4E14;&#x8BB8;&#x591A;&#x529F;&#x80FD;&#x7528;&#x4E8E;&#x64CD;&#x7EB5;&#x8FD9;&#x4E9B;&#x9635;&#x5217;&#x3002;
NumPy&#x7684;&#x662F;&#x79D1;&#x5B66;&#x8BA1;&#x7B97;&#x7684;&#x901A;&#x7528;&#x6846;&#x67B6;;&#x4E0D;&#x77E5;&#x9053;&#x8BA1;&#x7B97;&#x56FE;&#x5F62;&#xFF0C;&#x6216;&#x6DF1;&#x5B66;&#x4E60;&#xFF0C;&#x6216;&#x6E10;&#x53D8;&#x4EC0;&#x4E48;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F88;&#x5BB9;&#x6613;&#x5730;&#x4F7F;&#x7528;numpy&#x7684;&#x901A;&#x8FC7;&#x624B;&#x52A8;&#x6267;&#x884C;&#x524D;&#x8FDB;&#x5230;&#x9002;&#x5408;&#x7684;&#x4E24;&#x5C42;&#x7F51;&#x7EDC;&#x968F;&#x673A;&#x6570;&#x636E;&#x5E76;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x4F7F;&#x7528;numpy&#x7684;&#x64CD;&#x4F5C;&#x5411;&#x540E;&#x4F20;&#x9012;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import numpy as np

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random input and output data
x = np.random.randn(N, D_in)
y = np.random.randn(N, D_out)

# Randomly initialize weights
w1 = np.random.randn(D_in, H)
w2 = np.random.randn(H, D_out)

learning_rate = 1e-6
for t in range(500):
    # Forward pass: compute predicted y
    h = x.dot(w1)
    h_relu = np.maximum(h, 0)
    y_pred = h_relu.dot(w2)

    # Compute and print loss
    loss = np.square(y_pred - y).sum()
    print(t, loss)

    # Backprop to compute gradients of w1 and w2 with respect to loss
    grad_y_pred = 2.0 * (y_pred - y)
    grad_w2 = h_relu.T.dot(grad_y_pred)
    grad_h_relu = grad_y_pred.dot(w2.T)
    grad_h = grad_h_relu.copy()
    grad_h[h &lt; 0] = 0
    grad_w1 = x.T.dot(grad_h)

    # Update weights
    w1 -= learning_rate * grad_w1
    w2 -= learning_rate * grad_w2
</code></pre><h3 id="pytorch&#xFF1A;&#x5F20;&#x91CF;">PyTorch&#xFF1A;&#x5F20;&#x91CF;</h3>
<p>numpy&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x4F1F;&#x5927;&#x7684;&#x6846;&#x67B6;&#xFF0C;&#x4F46;&#x5B83;&#x4E0D;&#x80FD;&#x5229;&#x7528;GPU&#x6765;&#x52A0;&#x901F;&#x5176;&#x6570;&#x503C;&#x8BA1;&#x7B97;&#x3002;&#x5BF9;&#x4E8E;&#x73B0;&#x4EE3;&#x7684;&#x6DF1;&#x5C42;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;&#x56FE;&#x5F62;&#x5904;&#x7406;&#x5668;&#x901A;&#x5E38;&#x63D0;&#x4F9B;&#x7684;<a href="https://github.com/jcjohnson/cnn-benchmarks" target="_blank">
50&#x500D;&#x4EE5;&#x4E0A;</a>&#x7684;&#x52A0;&#x901F;&#xFF0C;&#x6240;&#x4EE5;&#x5F88;&#x9057;&#x61BE;numpy&#x7684;&#x5C06;&#x662F;&#x4E0D;&#x591F;&#x7684;&#x73B0;&#x4EE3;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x4ECB;&#x7ECD;&#x7684;&#x6700;&#x6839;&#x672C;PyTorch&#x6982;&#x5FF5;&#xFF1A;
<strong>&#x5F20;&#x91CF;[HTG1&#x3002;&#x7532;PyTorch&#x5F20;&#x91CF;&#x662F;&#x6982;&#x5FF5;&#x6027;&#x5730;&#x7B49;&#x540C;&#x4E8E;numpy&#x7684;&#x6570;&#x7EC4;&#xFF1A;&#x4E00;&#x4E2A;&#x5F20;&#x91CF;&#x662F;n&#x7EF4;&#x9635;&#x5217;&#xFF0C;&#x5E76;&#x4E14;PyTorch&#x5173;&#x4E8E;&#x8FD9;&#x4E9B;&#x5F20;&#x91CF;&#x7684;&#x64CD;&#x4F5C;&#x63D0;&#x4F9B;&#x4E86;&#x8BB8;&#x591A;&#x529F;&#x80FD;&#x3002;&#x5728;&#x5E55;&#x540E;&#xFF0C;&#x5F20;&#x91CF;&#x53EF;&#x4EE5;&#x8DDF;&#x8E2A;&#x7684;&#x8BA1;&#x7B97;&#x56FE;&#x8868;&#x548C;&#x6E10;&#x53D8;&#x7684;&#xFF0C;&#x4F46;&#x4ED6;&#x4EEC;&#x4E5F;&#x4E3A;&#x79D1;&#x5B66;&#x8BA1;&#x7B97;&#x7684;&#x901A;&#x7528;&#x5DE5;&#x5177;&#x662F;&#x6709;&#x7528;&#x7684;&#x3002;</strong></p>
<p>&#x4E5F;&#x4E0D;&#x50CF;numpy&#x7684;&#xFF0C;PyTorch&#x5F20;&#x91CF;&#x53EF;&#x4EE5;&#x5229;&#x7528;GPU&#x6765;&#x52A0;&#x901F;&#x4ED6;&#x4EEC;&#x7684;&#x6570;&#x503C;&#x8BA1;&#x7B97;&#x3002;&#x8981;&#x5728;GPU&#x8FD0;&#x884C;PyTorch&#x5F20;&#x91CF;&#xFF0C;&#x53EA;&#x9700;&#x5C06;&#x5B83;&#x8F6C;&#x6362;&#x4E3A;&#x65B0;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;PyTorch&#x5F20;&#x91CF;&#xFF0C;&#x4EE5;&#x9002;&#x5E94;&#x200B;&#x200B;&#x4E8C;&#x5C42;&#x7F51;&#x7EDC;&#x7684;&#x968F;&#x673A;&#x6570;&#x636E;&#x3002;&#x50CF;numpy&#x7684;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x624B;&#x52A8;&#x6267;&#x884C;&#x5411;&#x524D;&#x548C;&#x5411;&#x540E;&#x7684;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-

import torch


dtype = torch.float
device = torch.device(&quot;cpu&quot;)
# device = torch.device(&quot;cuda:0&quot;) # Uncomment this to run on GPU

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random input and output data
x = torch.randn(N, D_in, device=device, dtype=dtype)
y = torch.randn(N, D_out, device=device, dtype=dtype)

# Randomly initialize weights
w1 = torch.randn(D_in, H, device=device, dtype=dtype)
w2 = torch.randn(H, D_out, device=device, dtype=dtype)

learning_rate = 1e-6
for t in range(500):
    # Forward pass: compute predicted y
    h = x.mm(w1)
    h_relu = h.clamp(min=0)
    y_pred = h_relu.mm(w2)

    # Compute and print loss
    loss = (y_pred - y).pow(2).sum().item()
    if t % 100 == 99:
        print(t, loss)

    # Backprop to compute gradients of w1 and w2 with respect to loss
    grad_y_pred = 2.0 * (y_pred - y)
    grad_w2 = h_relu.t().mm(grad_y_pred)
    grad_h_relu = grad_y_pred.mm(w2.t())
    grad_h = grad_h_relu.clone()
    grad_h[h &lt; 0] = 0
    grad_w1 = x.t().mm(grad_h)

    # Update weights using gradient descent
    w1 -= learning_rate * grad_w1
    w2 -= learning_rate * grad_w2
</code></pre><h2 id="autograd">Autograd</h2>
<h3 id="pytorch&#xFF1A;&#x5F20;&#x91CF;&#x548C;autograd">PyTorch&#xFF1A;&#x5F20;&#x91CF;&#x548C;autograd</h3>
<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x624B;&#x52A8;&#x5B9E;&#x73B0;&#x6B63;&#x5411;&#x548C;&#x6211;&#x4EEC;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x843D;&#x540E;&#x901A;&#x884C;&#x8BC1;&#x3002;&#x624B;&#x52A8;&#x5B9E;&#x73B0;&#x540E;&#x5411;&#x901A;&#x884C;&#x662F;&#x4E0D;&#x662F;&#x4EC0;&#x4E48;&#x5927;&#x4E0D;&#x4E86;&#x7684;&#x4E00;&#x4E2A;&#x5C0F;&#x4E8C;&#x5C42;&#x7F51;&#x7EDC;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x8FC5;&#x901F;&#x5F97;&#x5230;&#x5927;&#x578B;&#x7684;&#x590D;&#x6742;&#x7F51;&#x7EDC;&#x975E;&#x5E38;&#x6709;&#x6BDB;&#x3002;</p>
<p>&#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a href="https://en.wikipedia.org/wiki/Automatic_differentiation" target="_blank">&#x81EA;&#x52A8;&#x5206;&#x5316;</a>&#x81EA;&#x52A8;&#x5316;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x5411;&#x540E;&#x4F20;&#x9012;&#x7684;&#x8BA1;&#x7B97;&#x3002;&#x5728;PyTorch&#x7684;
<strong>autograd</strong> &#x5305;&#x63D0;&#x4F9B;&#x7684;&#x6B63;&#x662F;&#x8FD9;&#x79CD;&#x529F;&#x80FD;&#x3002;&#x5F53;&#x4F7F;&#x7528;autograd&#xFF0C;&#x7F51;&#x7EDC;&#x7684;&#x76F4;&#x4F20;&#x5C06;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A; <strong>&#x8BA1;&#x7B97;&#x56FE;&#x8868;</strong>
;&#x56FE;&#x4E2D;&#x7684;&#x8282;&#x70B9;&#x5C06;&#x662F;&#x5F20;&#x91CF;&#xFF0C;&#x5E76;&#x4E14;&#x8FB9;&#x7F18;&#x5C06;&#x662F;&#x4EA7;&#x751F;&#x4ECE;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x5F20;&#x91CF;&#x5F20;&#x91CF;&#x7684;&#x529F;&#x80FD;&#x3002;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x56FE;&#x8868;Backpropagating&#x7136;&#x540E;&#x8BA9;&#x4F60;&#x8F7B;&#x677E;&#x8BA1;&#x7B97;&#x68AF;&#x5EA6;&#x3002;</p>
<p>&#x8FD9;&#x542C;&#x8D77;&#x6765;&#x5F88;&#x590D;&#x6742;&#xFF0C;&#x8FD9;&#x662F;&#x5F88;&#x7B80;&#x5355;&#x7684;&#x505A;&#x6CD5;&#x662F;&#x4F7F;&#x7528;&#x3002;&#x5404;&#x5F20;&#x91CF;&#x8868;&#x793A;&#x5728;&#x8BA1;&#x7B97;&#x56FE;&#x4E2D;&#x7684;&#x8282;&#x70B9;&#x3002;&#x5982;&#x679C;<code>&#xD7;</code>&#x662F;&#x4E00;&#x4E2A;&#x5F20;&#x91CF;&#xFF0C;&#x5176;&#x5177;&#x6709;<code>x.requires_grad =&#x771F;</code>&#x7136;&#x540E;<code>x.grad</code>&#x7684;&#x53E6;&#x4E00;&#x5F20;&#x91CF;&#x4FDD;&#x6301;&#x7684;<code>&#xD7;</code>&#x68AF;&#x5EA6;&#x76F8;&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;&#x6807;&#x91CF;&#x503C;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;PyTorch&#x5F20;&#x91CF;&#x548C;autograd&#x6765;&#x5B9E;&#x73B0;&#x6211;&#x4EEC;&#x7684;&#x4E24;&#x5C42;&#x7F51;&#x7EDC;;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x624B;&#x52A8;&#x5B9E;&#x73B0;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x5411;&#x901A;&#x884C;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import torch

dtype = torch.float
device = torch.device(&quot;cpu&quot;)
# device = torch.device(&quot;cuda:0&quot;) # Uncomment this to run on GPU

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random Tensors to hold input and outputs.
# Setting requires_grad=False indicates that we do not need to compute gradients
# with respect to these Tensors during the backward pass.
x = torch.randn(N, D_in, device=device, dtype=dtype)
y = torch.randn(N, D_out, device=device, dtype=dtype)

# Create random Tensors for weights.
# Setting requires_grad=True indicates that we want to compute gradients with
# respect to these Tensors during the backward pass.
w1 = torch.randn(D_in, H, device=device, dtype=dtype, requires_grad=True)
w2 = torch.randn(H, D_out, device=device, dtype=dtype, requires_grad=True)

learning_rate = 1e-6
for t in range(500):
    # Forward pass: compute predicted y using operations on Tensors; these
    # are exactly the same operations we used to compute the forward pass using
    # Tensors, but we do not need to keep references to intermediate values since
    # we are not implementing the backward pass by hand.
    y_pred = x.mm(w1).clamp(min=0).mm(w2)

    # Compute and print loss using operations on Tensors.
    # Now loss is a Tensor of shape (1,)
    # loss.item() gets the scalar value held in the loss.
    loss = (y_pred - y).pow(2).sum()
    if t % 100 == 99:
        print(t, loss.item())

    # Use autograd to compute the backward pass. This call will compute the
    # gradient of loss with respect to all Tensors with requires_grad=True.
    # After this call w1.grad and w2.grad will be Tensors holding the gradient
    # of the loss with respect to w1 and w2 respectively.
    loss.backward()

    # Manually update weights using gradient descent. Wrap in torch.no_grad()
    # because weights have requires_grad=True, but we don&apos;t need to track this
    # in autograd.
    # An alternative way is to operate on weight.data and weight.grad.data.
    # Recall that tensor.data gives a tensor that shares the storage with
    # tensor, but doesn&apos;t track history.
    # You can also use torch.optim.SGD to achieve this.
    with torch.no_grad():
        w1 -= learning_rate * w1.grad
        w2 -= learning_rate * w2.grad

        # Manually zero the gradients after updating weights
        w1.grad.zero_()
        w2.grad.zero_()
</code></pre><h3 id="pytorch&#xFF1A;&#x5B9A;&#x4E49;&#x65B0;autograd&#x529F;&#x80FD;">PyTorch&#xFF1A;&#x5B9A;&#x4E49;&#x65B0;autograd&#x529F;&#x80FD;</h3>
<p>&#x5728;&#x5185;&#x90E8;&#xFF0C;&#x6BCF;&#x4E2A;&#x57FA;&#x5143;autograd&#x64CD;&#x4F5C;&#x8005;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x5F20;&#x91CF;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#x3002;&#x7684; <strong>&#x5411;&#x524D;</strong> &#x51FD;&#x6570;&#x4ECE;&#x8F93;&#x5165;&#x5F20;&#x91CF;&#x8BA1;&#x7B97;&#x8F93;&#x51FA;&#x5F20;&#x91CF;&#x3002;&#x7684; <strong>&#x5411;&#x540E;</strong>
&#x529F;&#x80FD;&#x63A5;&#x6536;&#x8F93;&#x51FA;&#x5F20;&#x91CF;&#x7684;&#x68AF;&#x5EA6;&#x76F8;&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;&#x6807;&#x91CF;&#x503C;&#xFF0C;&#x5E76;&#x8BA1;&#x7B97;&#x8F93;&#x5165;&#x5F20;&#x91CF;&#x7684;&#x68AF;&#x5EA6;&#x76F8;&#x5BF9;&#x4E8E;&#x8BE5;&#x76F8;&#x540C;&#x6807;&#x91CF;&#x503C;&#x3002;</p>
<p>&#x5728;PyTorch&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F88;&#x5BB9;&#x6613;&#x5730;&#x901A;&#x8FC7;&#x5B9A;&#x4E49;<code>torch.autograd.Function</code>&#x4E00;&#x4E2A;&#x5B50;&#x7C7B;&#xFF0C;&#x5E76;&#x5B9E;&#x73B0;&#x4E86;<code>&#x8F6C;&#x53D1;</code>&#x548C;&#x5B9A;&#x4E49;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;autograd&#x64CD;&#x4F5C;<code>&#x5411;&#x540E;</code>&#x529F;&#x80FD;&#x3002;&#x7136;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#xFF0C;&#x5E76;&#x8C03;&#x7528;&#x5B83;&#x50CF;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x4F20;&#x9012;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x8F93;&#x5165;&#x6570;&#x636E;&#x7684;&#x5F20;&#x91CF;&#x4F7F;&#x7528;&#x6211;&#x4EEC;&#x7684;&#x65B0;autograd&#x8FD0;&#x8425;&#x5546;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x7684;&#x81EA;&#x5B9A;&#x4E49;autograd&#x529F;&#x80FD;&#x8FDB;&#x884C;RELU&#x975E;&#x7EBF;&#x6027;&#xFF0C;&#x5E76;&#x7528;&#x5B83;&#x6765;&#x5B9E;&#x73B0;&#x6211;&#x4EEC;&#x7684;&#x4E24;&#x5C42;&#x7F51;&#x7EDC;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import torch


class MyReLU(torch.autograd.Function):
    &quot;&quot;&quot;
    We can implement our own custom autograd Functions by subclassing
    torch.autograd.Function and implementing the forward and backward passes
    which operate on Tensors.
    &quot;&quot;&quot;

    @staticmethod
    def forward(ctx, input):
        &quot;&quot;&quot;
        In the forward pass we receive a Tensor containing the input and return
        a Tensor containing the output. ctx is a context object that can be used
        to stash information for backward computation. You can cache arbitrary
        objects for use in the backward pass using the ctx.save_for_backward method.
        &quot;&quot;&quot;
        ctx.save_for_backward(input)
        return input.clamp(min=0)

    @staticmethod
    def backward(ctx, grad_output):
        &quot;&quot;&quot;
        In the backward pass we receive a Tensor containing the gradient of the loss
        with respect to the output, and we need to compute the gradient of the loss
        with respect to the input.
        &quot;&quot;&quot;
        input, = ctx.saved_tensors
        grad_input = grad_output.clone()
        grad_input[input &lt; 0] = 0
        return grad_input


dtype = torch.float
device = torch.device(&quot;cpu&quot;)
# device = torch.device(&quot;cuda:0&quot;) # Uncomment this to run on GPU

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random Tensors to hold input and outputs.
x = torch.randn(N, D_in, device=device, dtype=dtype)
y = torch.randn(N, D_out, device=device, dtype=dtype)

# Create random Tensors for weights.
w1 = torch.randn(D_in, H, device=device, dtype=dtype, requires_grad=True)
w2 = torch.randn(H, D_out, device=device, dtype=dtype, requires_grad=True)

learning_rate = 1e-6
for t in range(500):
    # To apply our Function, we use Function.apply method. We alias this as &apos;relu&apos;.
    relu = MyReLU.apply

    # Forward pass: compute predicted y using operations; we compute
    # ReLU using our custom autograd operation.
    y_pred = relu(x.mm(w1)).mm(w2)

    # Compute and print loss
    loss = (y_pred - y).pow(2).sum()
    if t % 100 == 99:
        print(t, loss.item())

    # Use autograd to compute the backward pass.
    loss.backward()

    # Update weights using gradient descent
    with torch.no_grad():
        w1 -= learning_rate * w1.grad
        w2 -= learning_rate * w2.grad

        # Manually zero the gradients after updating weights
        w1.grad.zero_()
        w2.grad.zero_()
</code></pre><h3 id="tensorflow&#xFF1A;&#x9759;&#x6001;&#x56FE;&#x5F62;">TensorFlow&#xFF1A;&#x9759;&#x6001;&#x56FE;&#x5F62;</h3>
<p>PyTorch
autograd&#x770B;&#x8D77;&#x6765;&#x5F88;&#x50CF;TensorFlow&#xFF1A;&#x5728;&#x4E24;&#x4E2A;&#x6846;&#x67B6;&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x7684;&#x8BA1;&#x7B97;&#x56FE;&#x8868;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x81EA;&#x52A8;&#x5FAE;&#x5206;&#x8BA1;&#x7B97;&#x68AF;&#x5EA6;&#x3002;&#x4E24;&#x8005;&#x4E4B;&#x95F4;&#x6700;&#x5927;&#x7684;&#x533A;&#x522B;&#x662F;&#xFF0C;TensorFlow&#x7684;&#x8BA1;&#x7B97;&#x56FE;&#x662F;
<strong>&#x9759;&#x6001;</strong> &#x548C;PyTorch&#x4F7F;&#x7528; <strong>&#x52A8;&#x6001;</strong> &#x8BA1;&#x7B97;&#x56FE;&#x8868;&#x3002;</p>
<p>&#x5728;TensorFlow&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E86;&#x8BA1;&#x7B97;&#x56FE;&#x5F62;&#x4E00;&#x6B21;&#xFF0C;&#x7136;&#x540E;&#x4E00;&#x904D;&#x4E00;&#x904D;&#x6267;&#x884C;&#x76F8;&#x540C;&#x7684;&#x66F2;&#x7EBF;&#x56FE;&#xFF0C;&#x53EF;&#x80FD;&#x4F9B;&#x7ED9;&#x4E0D;&#x540C;&#x7684;&#x8F93;&#x5165;&#x6570;&#x636E;&#x63D0;&#x4F9B;&#x7ED9;&#x56FE;&#x3002;&#x5728;PyTorch&#xFF0C;&#x6BCF;&#x4E2A;&#x76F4;&#x4F20;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x8BA1;&#x7B97;&#x66F2;&#x7EBF;&#x56FE;&#x3002;</p>
<p>&#x9759;&#x6001;&#x56FE;&#x662F;&#x5F88;&#x597D;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x524D;&#x9762;&#x4F18;&#x5316;&#x56FE;&#x5F62;;&#x4F8B;&#x5982;&#x6846;&#x67B6;&#x53EF;&#x80FD;&#x51B3;&#x5B9A;&#x4E00;&#x4E9B;&#x878D;&#x5408;&#x56FE;&#x7684;&#x8FD0;&#x7B97;&#x6548;&#x7387;&#xFF0C;&#x8FD8;&#x662F;&#x62FF;&#x51FA;&#x4E86;&#x5728;&#x8BB8;&#x591A;&#x7684;GPU&#x6216;&#x8005;&#x591A;&#x53F0;&#x673A;&#x5668;&#x5206;&#x5E03;&#x56FE;&#x7684;&#x7B56;&#x7565;&#x3002;&#x5982;&#x679C;&#x4F60;&#x4E00;&#x904D;&#x53C8;&#x4E00;&#x904D;&#x5730;&#x91CD;&#x590D;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x5F20;&#x56FE;&#x4E0A;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x79CD;&#x6F5C;&#x5728;&#x7684;&#x6602;&#x8D35;&#x7684;&#x524D;&#x671F;&#x4F18;&#x5316;&#xFF0C;&#x53EF;&#x4EE5;&#x644A;&#x9500;&#x5728;&#x540C;&#x4E00;&#x5F20;&#x56FE;&#x4E2D;&#x4E00;&#x904D;&#x53C8;&#x4E00;&#x904D;&#x5730;&#x91CD;&#x65B0;&#x8FD0;&#x884C;&#x3002;</p>
<p>&#x5176;&#x4E2D;&#x7684;&#x9759;&#x6001;&#x548C;&#x52A8;&#x6001;&#x7684;&#x66F2;&#x7EBF;&#x56FE;&#x4E0D;&#x540C;&#x7684;&#x4E00;&#x4E2A;&#x65B9;&#x9762;&#x662F;&#x63A7;&#x5236;&#x6D41;&#x3002;&#x5BF9;&#x4E8E;&#x67D0;&#x4E9B;&#x578B;&#x53F7;&#x6211;&#x4EEC;&#x53EF;&#x80FD;&#x5E0C;&#x671B;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x6570;&#x636E;&#x70B9;&#x6267;&#x884C;&#x4E0D;&#x540C;&#x7684;&#x8BA1;&#x7B97;;&#x4F8B;&#x5982;&#x590D;&#x53D1;&#x6027;&#x7F51;&#x7EDC;&#x53EF;&#x80FD;&#x88AB;&#x5C55;&#x5F00;&#x4E3A;&#x4E0D;&#x540C;&#x6570;&#x91CF;&#x7684;&#x6BCF;&#x4E2A;&#x6570;&#x636E;&#x70B9;&#x7684;&#x65F6;&#x95F4;&#x6B65;;&#x8FD9;&#x6837;&#x5C55;&#x5F00;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5FAA;&#x73AF;&#x6765;&#x5B9E;&#x73B0;&#x3002;&#x5177;&#x6709;&#x9759;&#x6001;&#x56FE;&#x4E2D;&#x7684;&#x5FAA;&#x73AF;&#x7ED3;&#x6784;&#x9700;&#x8981;&#x662F;&#x56FE;&#x5F62;&#x7684;&#x4E00;&#x90E8;&#x5206;;&#x4E3A;&#x6B64;TensorFlow&#x4E3A;&#x8FD0;&#x8425;&#x5546;&#x63D0;&#x4F9B;&#x5982;<code>tf.scan</code>&#x5D4C;&#x5165;&#x5FAA;&#x73AF;&#x5230;&#x66F2;&#x7EBF;&#x56FE;&#x3002;&#x968F;&#x7740;&#x52A8;&#x6001;&#x56FE;&#x5F62;&#x7684;&#x60C5;&#x51B5;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF1A;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x5EFA;&#x7ACB;&#x5728;&#x5373;&#x65F6;&#x6BCF;&#x4E2A;&#x793A;&#x4F8B;&#x56FE;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;&#x6B63;&#x5E38;&#x7684;&#x5FC5;&#x8981;&#x7684;&#x6D41;&#x91CF;&#x63A7;&#x5236;&#x6765;&#x6267;&#x884C;&#x8BA1;&#x7B97;&#x7684;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x6BCF;&#x4E2A;&#x8F93;&#x5165;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x4E0E;PyTorch&#x5BF9;&#x6BD4;&#x4E0A;&#x8FF0;autograd&#x4F8B;&#x5B50;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;TensorFlow&#xFF0C;&#x4EE5;&#x9002;&#x5E94;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4E24;&#x5C42;&#x7F51;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import tensorflow as tf
import numpy as np

# First we set up the computational graph:

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create placeholders for the input and target data; these will be filled
# with real data when we execute the graph.
x = tf.placeholder(tf.float32, shape=(None, D_in))
y = tf.placeholder(tf.float32, shape=(None, D_out))

# Create Variables for the weights and initialize them with random data.
# A TensorFlow Variable persists its value across executions of the graph.
w1 = tf.Variable(tf.random_normal((D_in, H)))
w2 = tf.Variable(tf.random_normal((H, D_out)))

# Forward pass: Compute the predicted y using operations on TensorFlow Tensors.
# Note that this code does not actually perform any numeric operations; it
# merely sets up the computational graph that we will later execute.
h = tf.matmul(x, w1)
h_relu = tf.maximum(h, tf.zeros(1))
y_pred = tf.matmul(h_relu, w2)

# Compute loss using operations on TensorFlow Tensors
loss = tf.reduce_sum((y - y_pred) ** 2.0)

# Compute gradient of the loss with respect to w1 and w2.
grad_w1, grad_w2 = tf.gradients(loss, [w1, w2])

# Update the weights using gradient descent. To actually update the weights
# we need to evaluate new_w1 and new_w2 when executing the graph. Note that
# in TensorFlow the the act of updating the value of the weights is part of
# the computational graph; in PyTorch this happens outside the computational
# graph.
learning_rate = 1e-6
new_w1 = w1.assign(w1 - learning_rate * grad_w1)
new_w2 = w2.assign(w2 - learning_rate * grad_w2)

# Now we have built our computational graph, so we enter a TensorFlow session to
# actually execute the graph.
with tf.Session() as sess:
    # Run the graph once to initialize the Variables w1 and w2.
    sess.run(tf.global_variables_initializer())

    # Create numpy arrays holding the actual data for the inputs x and targets
    # y
    x_value = np.random.randn(N, D_in)
    y_value = np.random.randn(N, D_out)
    for t in range(500):
        # Execute the graph many times. Each time it executes we want to bind
        # x_value to x and y_value to y, specified with the feed_dict argument.
        # Each time we execute the graph we want to compute the values for loss,
        # new_w1, and new_w2; the values of these Tensors are returned as numpy
        # arrays.
        loss_value, _, _ = sess.run([loss, new_w1, new_w2],
                                    feed_dict={x: x_value, y: y_value})
        if t % 100 == 99:
            print(t, loss_value)
</code></pre><h2 id="nn-&#x6A21;&#x5757;">NN &#x6A21;&#x5757;</h2>
<h3 id="pytorch&#xFF1A;nn">PyTorch&#xFF1A;NN</h3>
<p>&#x8BA1;&#x7B97;&#x56FE;&#x5F62;&#x548C;autograd&#x662F;&#x7528;&#x4E8E;&#x5B9A;&#x4E49;&#x590D;&#x6742;&#x7684;&#x64CD;&#x4F5C;&#x4EBA;&#x5458;&#x548C;&#x81EA;&#x52A8;&#x91C7;&#x53D6;&#x884D;&#x751F;&#x7269;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x5F3A;&#x5927;&#x7684;&#x8303;&#x4F8B;;&#x7136;&#x800C;&#xFF0C;&#x5BF9;&#x4E8E;&#x5927;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x539F;&#x59CB;autograd&#x53EF;&#x4EE5;&#x6709;&#x70B9;&#x592A;&#x7EA7;&#x4F4E;&#x3002;</p>
<p>&#x5F53;&#x5EFA;&#x7ACB;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;&#x6211;&#x4EEC;&#x7ECF;&#x5E38;&#x60F3;&#x5B89;&#x6392;&#x8BA1;&#x7B97;&#x5206;&#x6210; <strong>&#x56FE;&#x5C42;</strong> &#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E9B; <strong>&#x5B66;&#x5F97;&#x7684;&#x53C2;&#x6570;</strong> &#x5C06;&#x5728;&#x5B66;&#x4E60;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F18;&#x5316;&#x3002;</p>
<p>&#x5728;TensorFlow&#xFF0C;&#x5982;<a href="https://github.com/fchollet/keras" target="_blank">&#x5305;Keras </a>&#xFF0C;<a href="https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/slim" target="_blank">
TensorFlow&#x4FEE;&#x8EAB;</a>&#x548C;<a href="http://tflearn.org/" target="_blank">
TFLearn </a>&#x901A;&#x8FC7;&#x539F;&#x59CB;&#x7684;&#x8BA1;&#x7B97;&#x56FE;&#x8868;&#xFF0C;&#x662F;&#x6784;&#x5EFA;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x6709;&#x7528;&#x63D0;&#x4F9B;&#x66F4;&#x9AD8;&#x5C42;&#x6B21;&#x7684;&#x62BD;&#x8C61;&#x3002;</p>
<p>&#x5728;PyTorch&#x65F6;&#xFF0C;<code>NN</code>&#x5305;&#x670D;&#x52A1;&#x4E8E;&#x8FD9;&#x4E2A;&#x76F8;&#x540C;&#x7684;&#x76EE;&#x7684;&#x3002;&#x7684;<code>NN</code>&#x5305;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x7EC4;&#x6A21;&#x5757;&#xFF0C;&#x5B83;&#x5927;&#x81F4;&#x76F8;&#x5F53;&#x4E8E;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5C42;&#x7684;
<strong>&#x3002;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#x63A5;&#x6536;&#x8F93;&#x5165;&#x5F20;&#x91CF;&#xFF0C;&#x5E76;&#x4E14;&#x8BA1;&#x7B97;&#x8F93;&#x51FA;&#x5F20;&#x91CF;&#xFF0C;&#x800C;&#x4E14;&#x8FD8;&#x53EF;&#x4EE5;&#x4FDD;&#x6301;&#x5185;&#x90E8;&#x72B6;&#x6001;&#xFF0C;&#x5982;&#x542B;&#x6709;&#x53EF;&#x4EE5;&#x5B66;&#x4E60;&#x53C2;&#x6570;&#x5F20;&#x91CF;&#x3002;&#x7684;<code>NN</code>&#x5305;&#x8FD8;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x7EC4;&#x8BAD;&#x7EC3;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x65F6;&#xFF0C;&#x901A;&#x5E38;&#x4F7F;&#x7528;&#x7684;&#x6709;&#x7528;&#x7684;&#x635F;&#x5931;&#x51FD;&#x6570;&#x3002;</strong></p>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<code>NN</code>&#x5305;&#x6765;&#x5B9E;&#x73B0;&#x6211;&#x4EEC;&#x7684;&#x4E24;&#x5C42;&#x7F51;&#x7EDC;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import torch

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random Tensors to hold inputs and outputs
x = torch.randn(N, D_in)
y = torch.randn(N, D_out)

# Use the nn package to define our model as a sequence of layers. nn.Sequential
# is a Module which contains other Modules, and applies them in sequence to
# produce its output. Each Linear Module computes output from input using a
# linear function, and holds internal Tensors for its weight and bias.
model = torch.nn.Sequential(
    torch.nn.Linear(D_in, H),
    torch.nn.ReLU(),
    torch.nn.Linear(H, D_out),
)

# The nn package also contains definitions of popular loss functions; in this
# case we will use Mean Squared Error (MSE) as our loss function.
loss_fn = torch.nn.MSELoss(reduction=&apos;sum&apos;)

learning_rate = 1e-4
for t in range(500):
    # Forward pass: compute predicted y by passing x to the model. Module objects
    # override the __call__ operator so you can call them like functions. When
    # doing so you pass a Tensor of input data to the Module and it produces
    # a Tensor of output data.
    y_pred = model(x)

    # Compute and print loss. We pass Tensors containing the predicted and true
    # values of y, and the loss function returns a Tensor containing the
    # loss.
    loss = loss_fn(y_pred, y)
    if t % 100 == 99:
        print(t, loss.item())

    # Zero the gradients before running the backward pass.
    model.zero_grad()

    # Backward pass: compute gradient of the loss with respect to all the learnable
    # parameters of the model. Internally, the parameters of each Module are stored
    # in Tensors with requires_grad=True, so this call will compute gradients for
    # all learnable parameters in the model.
    loss.backward()

    # Update the weights using gradient descent. Each parameter is a Tensor, so
    # we can access its gradients like we did before.
    with torch.no_grad():
        for param in model.parameters():
            param -= learning_rate * param.grad
</code></pre><h3 id="pytorch&#xFF1A;&#x7684;optim">PyTorch&#xFF1A;&#x7684;Optim</h3>
<p>&#x5230;&#x73B0;&#x5728;&#x4E3A;&#x6B62;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x4EBA;&#x5DE5;&#x53D8;&#x5F02;&#x7684;&#x5F20;&#x91CF;&#x4FDD;&#x6301;&#x53EF;&#x5B66;&#x4E60;&#x53C2;&#x6570;&#xFF08;<code>torch.no_grad&#xFF08;&#xFF09;</code>&#x6216;<code>&#x3002;&#x6570;&#x636E;[HTG6&#x66F4;&#x65B0;&#x4E86;&#x6A21;&#x578B;&#x7684;&#x91CD;&#x91CF;]</code>&#x4EE5;&#x907F;&#x514D;&#x5728;autograd&#x8DDF;&#x8E2A;&#x5386;&#x53F2;&#xFF09;&#x3002;&#x8FD9;&#x4E0D;&#x662F;&#x7B80;&#x5355;&#x7684;&#x4F18;&#x5316;&#x7B97;&#x6CD5;&#xFF0C;&#x5982;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x4E00;&#x4E2A;&#x5DE8;&#x5927;&#x7684;&#x8D1F;&#x62C5;&#xFF0C;&#x4F46;&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x7ECF;&#x5E38;&#x4F7F;&#x7528;&#x66F4;&#x590D;&#x6742;&#x7684;&#x4F18;&#x5316;&#x50CF;AdaGrad&#xFF0C;RMSProp&#xFF0C;&#x4E9A;&#x5F53;&#x7B49;&#x8BAD;&#x7EC3;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;</p>
<p>&#x7684;<code>&#x7684;Optim</code>&#x5305;&#x5728;PyTorch&#x593A;&#x53D6;&#x4F18;&#x5316;&#x7B97;&#x6CD5;&#x7684;&#x601D;&#x60F3;&#xFF0C;&#x5E76;&#x63D0;&#x4F9B;&#x4E86;&#x5E38;&#x7528;&#x7684;&#x4F18;&#x5316;&#x7B97;&#x6CD5;&#x7684;&#x5B9E;&#x65BD;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;<code>NN</code>&#x5C01;&#x88C5;&#x4E4B;&#x524D;&#x5B9A;&#x4E49;&#x6211;&#x4EEC;&#x7684;&#x6A21;&#x578B;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;&#x7531;<code>&#x7684;Optim&#x63D0;&#x4F9B;&#x7684;&#x4E9A;&#x5F53;&#x7B97;&#x6CD5;[HTG6&#x4F18;&#x5316;&#x6A21;&#x578B;]</code>&#x5305;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import torch

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random Tensors to hold inputs and outputs
x = torch.randn(N, D_in)
y = torch.randn(N, D_out)

# Use the nn package to define our model and loss function.
model = torch.nn.Sequential(
    torch.nn.Linear(D_in, H),
    torch.nn.ReLU(),
    torch.nn.Linear(H, D_out),
)
loss_fn = torch.nn.MSELoss(reduction=&apos;sum&apos;)

# Use the optim package to define an Optimizer that will update the weights of
# the model for us. Here we will use Adam; the optim package contains many other
# optimization algoriths. The first argument to the Adam constructor tells the
# optimizer which Tensors it should update.
learning_rate = 1e-4
optimizer = torch.optim.Adam(model.parameters(), lr=learning_rate)
for t in range(500):
    # Forward pass: compute predicted y by passing x to the model.
    y_pred = model(x)

    # Compute and print loss.
    loss = loss_fn(y_pred, y)
    if t % 100 == 99:
        print(t, loss.item())

    # Before the backward pass, use the optimizer object to zero all of the
    # gradients for the variables it will update (which are the learnable
    # weights of the model). This is because by default, gradients are
    # accumulated in buffers( i.e, not overwritten) whenever .backward()
    # is called. Checkout docs of torch.autograd.backward for more details.
    optimizer.zero_grad()

    # Backward pass: compute gradient of the loss with respect to model
    # parameters
    loss.backward()

    # Calling the step function on an Optimizer makes an update to its
    # parameters
    optimizer.step()
</code></pre><h3 id="pytorch&#xFF1A;&#x81EA;&#x5B9A;&#x4E49;&#x30F3;&#x6A21;&#x5757;">PyTorch&#xFF1A;&#x81EA;&#x5B9A;&#x4E49;&#x30F3;&#x6A21;&#x5757;</h3>
<p>&#x6709;&#x65F6;&#x4F60;&#x4F1A;&#x60F3;&#x6307;&#x5B9A;&#x578B;&#x53F7;&#x662F;&#x6BD4;&#x73B0;&#x6709;&#x6A21;&#x5757;&#x7684;&#x5E8F;&#x5217;&#x66F4;&#x52A0;&#x590D;&#x6742;;&#x5BF9;&#x4E8E;&#x8FD9;&#x4E9B;&#x60C5;&#x51B5;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7EE7;&#x627F;<code>nn.Module</code>&#x548C;&#x5B9A;&#x4E49;[&#x5B9A;&#x4E49;&#x4F60;&#x81EA;&#x5DF1;&#x7684;&#x6A21;&#x5757;HTG4] &#x5411;&#x524D;
&#x63A5;&#x6536;&#x8F93;&#x5165;&#x5F20;&#x91CF;&#x548C;&#x4F7F;&#x7528;&#x7684;&#x5176;&#x4ED6;&#x6A21;&#x5757;&#x6216;&#x5176;&#x4ED6;&#x5F20;&#x91CF;&#x8FD0;&#x7B97;autograd&#x4EA7;&#x751F;&#x8F93;&#x51FA;&#x5F20;&#x91CF;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5B9E;&#x73B0;&#x6211;&#x4EEC;&#x7684;&#x4E24;&#x5C42;&#x7F51;&#x7EDC;&#x4F5C;&#x4E3A;&#x81EA;&#x5B9A;&#x4E49;&#x6A21;&#x5757;&#x7684;&#x5B50;&#x7C7B;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import torch


class TwoLayerNet(torch.nn.Module):
    def __init__(self, D_in, H, D_out):
        &quot;&quot;&quot;
        In the constructor we instantiate two nn.Linear modules and assign them as
        member variables.
        &quot;&quot;&quot;
        super(TwoLayerNet, self).__init__()
        self.linear1 = torch.nn.Linear(D_in, H)
        self.linear2 = torch.nn.Linear(H, D_out)

    def forward(self, x):
        &quot;&quot;&quot;
        In the forward function we accept a Tensor of input data and we must return
        a Tensor of output data. We can use Modules defined in the constructor as
        well as arbitrary operators on Tensors.
        &quot;&quot;&quot;
        h_relu = self.linear1(x).clamp(min=0)
        y_pred = self.linear2(h_relu)
        return y_pred


# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random Tensors to hold inputs and outputs
x = torch.randn(N, D_in)
y = torch.randn(N, D_out)

# Construct our model by instantiating the class defined above
model = TwoLayerNet(D_in, H, D_out)

# Construct our loss function and an Optimizer. The call to model.parameters()
# in the SGD constructor will contain the learnable parameters of the two
# nn.Linear modules which are members of the model.
criterion = torch.nn.MSELoss(reduction=&apos;sum&apos;)
optimizer = torch.optim.SGD(model.parameters(), lr=1e-4)
for t in range(500):
    # Forward pass: Compute predicted y by passing x to the model
    y_pred = model(x)

    # Compute and print loss
    loss = criterion(y_pred, y)
    if t % 100 == 99:
        print(t, loss.item())

    # Zero gradients, perform a backward pass, and update the weights.
    optimizer.zero_grad()
    loss.backward()
    optimizer.step()
</code></pre><h3 id="pytorch&#xFF1A;&#x63A7;&#x5236;&#x6D41;&#x91CD;&#x91CF;&#x5171;&#x4EAB;">PyTorch&#xFF1A;&#x63A7;&#x5236;&#x6D41;+&#x91CD;&#x91CF;&#x5171;&#x4EAB;</h3>
<p>&#x52A8;&#x6001;&#x56FE;&#x5F62;&#x548C;&#x91CD;&#x91CF;&#x5171;&#x4EAB;&#x7684;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x6211;&#x4EEC;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5F88;&#x5947;&#x602A;&#x7684;&#x6A21;&#x578B;&#xFF1A;&#x5373;&#x5728;&#x6BCF;&#x4E2A;&#x76F4;&#x4F20;&#x9009;&#x62E9;1&#x548C;4&#x4E4B;&#x95F4;&#x7684;&#x968F;&#x673A;&#x6570;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x8BE5;&#x8BB8;&#x591A;&#x9690;&#x85CF;&#x5C42;&#xFF0C;&#x591A;&#x6B21;&#x91CD;&#x590D;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x6743;&#x91CD;&#x5168;&#x8FDE;&#x63A5;RELU&#x7F51;&#x7EDC;&#x8BA1;&#x7B97;&#x9690;&#x85CF;&#x6700;&#x5185;&#x5C42;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x8FD9;&#x4E2A;&#x6A21;&#x578B;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x666E;&#x901A;&#x7684;Python&#x6D41;&#x91CF;&#x63A7;&#x5236;&#x6765;&#x5B9E;&#x73B0;&#x5FAA;&#x73AF;&#xFF0C;&#x5E76;&#x4E14;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5B9A;&#x4E49;&#x76F4;&#x4F20;&#x5F53;&#x591A;&#x6B21;&#x7B80;&#x5355;&#x5730;&#x91CD;&#x590D;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x6A21;&#x5757;&#x5B9E;&#x73B0;&#x6700;&#x5185;&#x5C42;&#x4E4B;&#x95F4;&#x91CD;&#x91CF;&#x5171;&#x4EAB;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F88;&#x5BB9;&#x6613;&#x5730;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x6A21;&#x578B;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#x7684;&#x5B50;&#x7C7B;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import random
import torch


class DynamicNet(torch.nn.Module):
    def __init__(self, D_in, H, D_out):
        &quot;&quot;&quot;
        In the constructor we construct three nn.Linear instances that we will use
        in the forward pass.
        &quot;&quot;&quot;
        super(DynamicNet, self).__init__()
        self.input_linear = torch.nn.Linear(D_in, H)
        self.middle_linear = torch.nn.Linear(H, H)
        self.output_linear = torch.nn.Linear(H, D_out)

    def forward(self, x):
        &quot;&quot;&quot;
        For the forward pass of the model, we randomly choose either 0, 1, 2, or 3
        and reuse the middle_linear Module that many times to compute hidden layer
        representations.

        Since each forward pass builds a dynamic computation graph, we can use normal
        Python control-flow operators like loops or conditional statements when
        defining the forward pass of the model.

        Here we also see that it is perfectly safe to reuse the same Module many
        times when defining a computational graph. This is a big improvement from Lua
        Torch, where each Module could be used only once.
        &quot;&quot;&quot;
        h_relu = self.input_linear(x).clamp(min=0)
        for _ in range(random.randint(0, 3)):
            h_relu = self.middle_linear(h_relu).clamp(min=0)
        y_pred = self.output_linear(h_relu)
        return y_pred


# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random Tensors to hold inputs and outputs
x = torch.randn(N, D_in)
y = torch.randn(N, D_out)

# Construct our model by instantiating the class defined above
model = DynamicNet(D_in, H, D_out)

# Construct our loss function and an Optimizer. Training this strange model with
# vanilla stochastic gradient descent is tough, so we use momentum
criterion = torch.nn.MSELoss(reduction=&apos;sum&apos;)
optimizer = torch.optim.SGD(model.parameters(), lr=1e-4, momentum=0.9)
for t in range(500):
    # Forward pass: Compute predicted y by passing x to the model
    y_pred = model(x)

    # Compute and print loss
    loss = criterion(y_pred, y)
    if t % 100 == 99:
        print(t, loss.item())

    # Zero gradients, perform a backward pass, and update the weights.
    optimizer.zero_grad()
    loss.backward()
    optimizer.step()
</code></pre><h2 id="&#x5B9E;&#x65BD;&#x4F8B;">&#x5B9E;&#x65BD;&#x4F8B;</h2>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;&#x6D4F;&#x89C8;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x3002;</p>
<h3 id="&#x5F20;&#x91CF;">&#x5F20;&#x91CF;</h3>
<p><img src="img/sphx_glr_two_layer_net_numpy_thumb.png" alt="img/sphx_glr_two_layer_net_numpy_thumb.png"></p>
<p><a href="examples_tensor/two_layer_net_numpy.html#sphx-glr-beginner-%0Aexamples-tensor-two-layer-net-numpy-py"> &#x70ED;&#x8EAB;&#xFF1A;numpy&#x7684; </a></p>
<p><img src="img/sphx_glr_two_layer_net_tensor_thumb.png" alt="img/sphx_glr_two_layer_net_tensor_thumb.png"></p>
<p><a href="examples_tensor/two_layer_net_tensor.html#sphx-glr-beginner-%0Aexamples-tensor-two-layer-net-tensor-py"> PyTorch&#xFF1A;&#x5F20;&#x91CF; </a></p>
<h3 id="autograd">Autograd</h3>
<p><img src="img/sphx_glr_two_layer_net_autograd_thumb.png" alt="img/sphx_glr_two_layer_net_autograd_thumb.png"></p>
<p><a href="examples_autograd/two_layer_net_autograd.html#sphx-%0Aglr-beginner-examples-autograd-two-layer-net-autograd-py"> PyTorch&#xFF1A;&#x5F20;&#x91CF;&#x548C;autograd  </a></p>
<p><img src="img/sphx_glr_two_layer_net_custom_function_thumb.png" alt="img/sphx_glr_two_layer_net_custom_function_thumb.png"></p>
<p><a href="examples_autograd/two_layer_net_custom_function.html#sphx-glr-beginner-%0Aexamples-autograd-two-layer-net-custom-function-py"> PyTorch&#xFF1A;&#x5B9A;&#x4E49;&#x65B0;autograd&#x529F;&#x80FD;
</a></p>
<p><img src="img/sphx_glr_tf_two_layer_net_thumb.png" alt="img/sphx_glr_tf_two_layer_net_thumb.png"></p>
<p><a href="examples_autograd/tf_two_layer_net.html#sphx-glr-beginner-%0Aexamples-autograd-tf-two-layer-net-py"> TensorFlow&#xFF1A;&#x9759;&#x6001;&#x56FE;&#x5F62; </a></p>
<h3 id="nn-&#x6A21;&#x5757;">NN &#x6A21;&#x5757;</h3>
<p><img src="img/sphx_glr_two_layer_net_nn_thumb.png" alt="img/sphx_glr_two_layer_net_nn_thumb.png"></p>
<p><a href="examples_nn/two_layer_net_nn.html#sphx-glr-beginner-examples-%0Ann-two-layer-net-nn-py"> PyTorch&#xFF1A;NN  </a></p>
<p><img src="img/sphx_glr_two_layer_net_optim_thumb.png" alt="img/sphx_glr_two_layer_net_optim_thumb.png"></p>
<p><a href="examples_nn/two_layer_net_optim.html#sphx-glr-beginner-%0Aexamples-nn-two-layer-net-optim-py"> PyTorch&#xFF1A;&#x7684;Optim  </a></p>
<p><img src="img/sphx_glr_two_layer_net_module_thumb.png" alt="img/sphx_glr_two_layer_net_module_thumb.png"></p>
<p><a href="examples_nn/two_layer_net_module.html#sphx-glr-beginner-%0Aexamples-nn-two-layer-net-module-py"> PyTorch&#xFF1A;&#x81EA;&#x5B9A;&#x4E49;&#x30F3;&#x6A21;&#x5757; </a></p>
<p><img src="img/sphx_glr_dynamic_net_thumb.png" alt="img/sphx_glr_dynamic_net_thumb.png"></p>
<p><a href="examples_nn/dynamic_net.html#sphx-glr-beginner-examples-%0Ann-dynamic-net-py"> PyTorch&#xFF1A;&#x63A7;&#x5236;&#x6D41;+&#x91CD;&#x91CF;&#x5171;&#x4EAB; </a></p>
<p><a href="examples_tensor/two_layer_net_numpy.html" title="Warm-up: numpy">Next <img src="../_static/images/chevron-right-
orange.svg" alt=""></a>
<a href="data_loading_tutorial.html" title="Data Loading and Processing Tutorial"><img src="../_static/images/chevron-right-orange.svg" alt="">
Previous</a></p>
<hr>
<p>Was this helpful?</p>
<p>Yes</p>
<p>No</p>
<p>Thank you</p>
<hr>
<p>&#xA9;&#x7248;&#x6743;&#x6240;&#x6709;2017&#x5E74;&#xFF0C;PyTorch&#x3002;</p>
<ul>
<li>&#x4E0E;&#x5B9E;&#x65BD;&#x4F8B;&#x5B66;&#x4E60;PyTorch <ul>
<li>&#x5F20;&#x91CF;<ul>
<li>&#x70ED;&#x8EAB;&#xFF1A;numpy&#x7684;</li>
<li>PyTorch&#xFF1A;&#x5F20;&#x91CF;</li>
</ul>
</li>
<li>Autograd <ul>
<li>PyTorch&#xFF1A;&#x5F20;&#x91CF;&#x548C;autograd </li>
<li>PyTorch&#xFF1A;&#x5B9A;&#x4E49;&#x65B0;autograd&#x529F;&#x80FD;</li>
<li>TensorFlow&#xFF1A;&#x9759;&#x6001;&#x56FE;&#x5F62;</li>
</ul>
</li>
<li>NN &#x6A21;&#x5757;<ul>
<li>PyTorch&#xFF1A;NN </li>
<li>PyTorch&#xFF1A;&#x7684;Optim </li>
<li>PyTorch&#xFF1A;&#x81EA;&#x5B9A;&#x4E49;&#x30F3;&#x6A21;&#x5757;</li>
<li>PyTorch&#xFF1A;&#x63A7;&#x5236;&#x6D41;+&#x91CD;&#x91CF;&#x5171;&#x4EAB;</li>
</ul>
</li>
<li>&#x5B9E;&#x65BD;&#x4F8B;<ul>
<li>&#x5F20;&#x91CF;</li>
<li>Autograd </li>
<li>NN &#x6A21;&#x5757;</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>![](<a href="https://www.facebook.com/tr?id=243028289693773&amp;ev=PageView" target="_blank">https://www.facebook.com/tr?id=243028289693773&amp;ev=PageView</a></p>
<p>  &amp;noscript=1)
<img src="https://www.googleadservices.com/pagead/conversion/795629140/?label=txkmCPmdtosBENSssfsC&amp;guid=ON&amp;script=0" alt=""></p>
<p><a href="https://www.facebook.com/pytorch" target="_blank"></a> <a href="https://twitter.com/pytorch" target="_blank"></a></p>
<p>&#x5206;&#x6790;&#x6D41;&#x91CF;&#x548C;&#x4F18;&#x5316;&#x7ECF;&#x9A8C;&#xFF0C;&#x6211;&#x4EEC;&#x4E3A;&#x8FD9;&#x4E2A;&#x7AD9;&#x70B9;&#x7684;Cookie&#x3002;&#x901A;&#x8FC7;&#x70B9;&#x51FB;&#x6216;&#x5BFC;&#x822A;&#xFF0C;&#x60A8;&#x540C;&#x610F;&#x6211;&#x4EEC;&#x7684;cookies&#x7684;&#x4F7F;&#x7528;&#x3002;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x7F51;&#x7AD9;&#x76EE;&#x524D;&#x7EF4;&#x62A4;&#x8005;&#xFF0C;Facebook&#x7684;Cookie&#x653F;&#x7B56;&#x7684;&#x9002;&#x7528;&#x3002;&#x4E86;&#x89E3;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x5305;&#x62EC;&#x6709;&#x5173;&#x53EF;&#x7528;&#x7684;&#x63A7;&#x5236;&#xFF1A;[&#x997C;&#x5E72;&#x653F;&#x7B56;<a href="https://www.facebook.com/policies/cookies/" target="_blank">HTG1&#x3002;</a></p>
<p><img src="../_static/images/pytorch-x.svg" alt=""></p>
<p><a href="https://pytorch.org/" target="_blank"></a></p>
<p><hr></p>
<div align="center">
    <p><a href="http://www.apachecn.org" target="_blank"><font face="KaiTi" size="6" color="red">&#x6211;&#x4EEC;&#x4E00;&#x76F4;&#x5728;&#x52AA;&#x529B;</font></a></p>
    <p><a href="https://github.com/apachecn/pytorch-doc-zh/" target="_blank">apachecn/pytorch-doc-zh</a></p>
    <p><iframe align="middle" src="https://ghbtns.com/github-btn.html?user=apachecn&amp;repo=pytorch-doc-zh&amp;type=watch&amp;count=true&amp;v=2" frameborder="0" scrolling="0" width="100px" height="25px"></iframe>
    <iframe align="middle" src="https://ghbtns.com/github-btn.html?user=apachecn&amp;repo=pytorch-doc-zh&amp;type=star&amp;count=true" frameborder="0" scrolling="0" width="100px" height="25px"></iframe>
    <iframe align="middle" src="https://ghbtns.com/github-btn.html?user=apachecn&amp;repo=pytorch-doc-zh&amp;type=fork&amp;count=true" frameborder="0" scrolling="0" width="100px" height="25px"></iframe>
    <a target="_blank" href="../shang.qq.com/wpa/qunwpa"><img border="0" src="http://data.apachecn.org/img/logo/ApacheCN-group.png" alt="ML | ApacheCN" title="ML | ApacheCN"></a></p>
</div>
 <div style="text-align:center;margin:0 0 10.5px;">
     <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
     <ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-3565452474788507" data-ad-slot="2543897000">
     </ins>
     <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>

    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?38525fdac4b5d4403900b943d4e7dd91";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
    </script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-102475051-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-102475051-10');
    </script>
</div>

<p><meta name="google-site-verification" content="pyo9N70ZWyh8JB43bIu633mhxesJ1IcwWCZlM3jUfFo"></p>
<p><iframe src="https://www.bilibili.com/read/cv2710377" style="display:none"></iframe>
<img src="http://t.cn/AiCoDHwb" hidden="hidden"></p>
<div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script>
    <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
    <div id="gitalk-container"></div>
    <script type="text/javascript">
        const gitalk = new Gitalk({
        clientID: '2e62dee5b9896e2eede6',
        clientSecret: 'ca6819a54656af0d87960af15315320f8a628a53',
        repo: 'pytorch-doc-zh',
        owner: 'apachecn',
        admin: ['jiangzhonglian', 'wizardforcel'],
        id: md5(location.pathname),
        distractionFreeMode: false
        })
        gitalk.render('gitalk-container')
    </script>
</div>

<footer class="page-footer"><span class="copyright">Copyright &#xA9; ibooker.org.cn 2019 all right reserved&#xFF0C;&#x7531; ApacheCN &#x56E2;&#x961F;&#x63D0;&#x4F9B;&#x652F;&#x6301;</span><span class="footer-modification">&#x8BE5;&#x6587;&#x4EF6;&#x4FEE;&#x8BA2;&#x65F6;&#x95F4;&#xFF1A; 
2019-10-08 07:52:30
</span></footer>
<script>console.log("plugin-popup....");document.onclick = function(e){ e.target.tagName === "IMG" && window.open(e.target.src,e.target.src)}</script><style>img{cursor:pointer}</style>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="data_loading_tutorial.html" class="navigation navigation-prev " aria-label="Previous page: 数据加载和处理教程">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="transfer_learning_tutorial.html" class="navigation navigation-next " aria-label="Next page: 迁移学习教程">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"用例子学习 PyTorch","level":"1.2.1.3","depth":3,"next":{"title":"迁移学习教程","level":"1.2.1.4","depth":3,"path":"beginner/transfer_learning_tutorial.md","ref":"beginner/transfer_learning_tutorial.md","articles":[]},"previous":{"title":"数据加载和处理教程","level":"1.2.1.2","depth":3,"path":"beginner/data_loading_tutorial.md","ref":"beginner/data_loading_tutorial.md","articles":[]},"dir":"ltr"},"config":{"plugins":["github","github-buttons","-sharing","insert-logo","sharing-plus","back-to-top-button","code","copy-code-button","mathjax","pageview-count","edit-link","emphasize","alerts","auto-scroll-table","popup","hide-element","page-toc-button","tbfed-pagefooter","sitemap","advanced-emoji","expandable-chapters","splitter","search-pro"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy ibooker.org.cn 2019","modify_label":"该文件修订时间： ","modify_format":"YYYY-MM-DD HH:mm:ss"},"emphasize":{},"github":{"url":"https://github.com/apachecn/pytorch-doc-zh"},"splitter":{},"search-pro":{},"search":{},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"auto-scroll-table":{},"popup":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code":{"copyButtons":true},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sitemap":{"hostname":"http://pytorch.apachecn.org"},"page-toc-button":{"maxTocDepth":4,"minTocSize":4},"back-to-top-button":{},"pageview-count":{},"alerts":{},"github-buttons":{"buttons":[{"user":"apachecn","repo":"pytorch-doc-zh","type":"star","count":true,"size":"small"}]},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"copy-code-button":{},"advanced-emoji":{"embedEmojis":false},"sharing":{"qq":false,"all":["qq","douban","facebook","google","linkedin","twitter","weibo","whatsapp"],"douban":false,"facebook":false,"weibo":true,"whatsapp":false,"twitter":false,"line":false,"google":false,"qzone":true},"edit-link":{"label":"编辑本页","base":"https://github.com/apachecn/pytorch-doc-zh/blob/master/docs/1.2"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"insert-logo":{"style":"background: none; max-height: 150px; min-height: 150px","url":"http://data.apachecn.org/img/logo.jpg"},"expandable-chapters":{}},"my_links":{"sidebar":{"Home":"https://www.baidu.com"}},"theme":"default","author":"ApacheCN","my_plugins":["donate","todo","-lunr","-search","expandable-chapters-small","chapter-fold","expandable-chapters","expandable-chapters-small","back-to-top-button","ga","baidu","sitemap","tbfed-pagefooter","advanced-emoji","sectionx","page-treeview","simple-page-toc","ancre-navigation","theme-apachecn@git+https://github.com/apachecn/theme-apachecn#HEAD","pagefooter-apachecn@git+https://github.com/apachecn/gitbook-plugin-pagefooter-apachecn#HEAD"],"my_pluginsConfig":{"page-treeview":{"copyright":"Copyright &#169; aleen42","minHeaderCount":"2","minHeaderDeep":"2"},"ignores":["node_modules"],"simple-page-toc":{"maxDepth":3,"skipFirstH1":true},"page-copyright":{"wisdom":"Designer, Frontend Developer & overall web enthusiast","noPowered":false,"copyright":"Copyright &#169; 你的名字","style":"normal","timeColor":"#666","utcOffset":"8","format":"YYYY-MM-dd hh:mm:ss","signature":"你的签名","copyrightColor":"#666","description":"modified at"},"donate":{"wechat":"微信收款的二维码URL","alipay":"支付宝收款的二维码URL","title":"","button":"赏","alipayText":"支付宝打赏","wechatText":"微信打赏"},"page-toc-button":{"maxTocDepth":2,"minTocSize":2},"github-buttons":{"buttons":[{"user":"apachecn","repo":"pytorch-doc-zh","type":"star","count":true,"size":"small"},{"user":"apachecn","width":"160","type":"follow","count":true,"size":"small"}]},"ga":{"token":"UA-102475051-10"},"baidu":{"token":"75439e2cbd22bdd813226000e9dcc12f"},"pagefooter-apachecn":{"copyright":"Copyright &copy ibooker.org.cn 2019","modify_label":"该文件修订时间： ","modify_format":"YYYY-MM-DD HH:mm:ss"}},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Pytorch 中文文档","language":"zh-hans","gitbook":"*","description":"Pytorch 中文文档: 教程和文档"},"file":{"path":"beginner/pytorch_with_examples.md","mtime":"2019-10-08T07:52:30.984Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-10-08T07:56:33.435Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-insert-logo/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-pageview-count/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-alerts/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

